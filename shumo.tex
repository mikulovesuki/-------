\documentclass{article}
\usepackage[UTF8]{ctex}
\usepackage{mathtools}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{float}
\usepackage{tikz}
\usepackage{graphicx}
\usepackage{indentfirst} % 使首段也缩进
\usepackage{forest}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{setspace} % 添加以支持 spacing 环境
\lstset{
    backgroundcolor=\color{gray!10}, % 背景色
    basicstyle=\ttfamily\small,      % 代码字体
    keywordstyle=\color{blue},       % 关键字颜色
    commentstyle=\color{gray},       % 注释颜色
    stringstyle=\color{red!70!black},% 字符串颜色
    numbers=left,                    % 行号显示在左侧
    numberstyle=\tiny\color{gray},
    breaklines=true,                 % 自动换行
    frame=single,                    % 框架
    tabsize=4,
    language=Python
}
\setlength{\parindent}{2em} % 设置首行缩进为两个汉字宽度
\everymath{\displaystyle}
\title{\large 基于解析几何和场景模拟的烟雾弹掩护目标投放策略(临时标题)}
\date{}
\begin{document}
\maketitle
\begin{center}
\section*{摘要}
\end{center}
\vspace{-1em}


\noindent


\noindent
\textbf{关键词：}\textit{关键词一}，\textit{关键词二}，\textit{关键词三}，\textit{}，\textit{}



\section{问题复述}

\subsection{问题背景}

在军事上，烟雾弹是一种用于掩护特定保护目标的战术装备。该装备通常搭配假干扰目标进行使用。\textit{烟幕干扰弹通过释放大量烟雾，形成视觉屏障，阻挡敌方的视线，以达到保护真实目标的目的。}在本材料中，烟幕干扰弹由无人机进行投掷。敌人发射多枚朝向假目标速度为$300m/s$的导弹，而我方的任务是通过投掷烟雾弹来掩护真实目标。在材料中，假目标和真实目标均为静止目标。假目标的坐标位置和真实目标的坐标位置均已知，其中假目标位于坐标轴原点，真目标位于$(0,200,0)$处，真目标为半径$7m$高度$10m$的圆柱体。我方携带烟幕弹无人机的部署位置均已知。敌人发射导弹的时间和位置均已知。烟雾弹投掷后的一段时间后会产生烟雾，烟雾会在20秒内持续存在，行程一个以烟幕弹为圆心半径为10$m$的球形烟幕团，并且烟幕团会以$3 m/s$的速度匀速下落，
持续时间为20$s$。为实现对真实目标的有效掩护，我方需要合理规划烟雾弹的投掷位置和时间，对无人机进行合理的调动，以确保在敌人导弹飞行过程中，真实目标尽可能处于于烟幕团的掩护范围内。其中无人机的飞行速度和方向一旦确定后，在飞行过程中均不可更改，且无人机不能改变飞行高度。

\textit{初始模型坐标位置可视化:}

\subsection{问题一}

已知无人机FY1位于$(17800,0,1800)$处，现在敌人从$(20000,0,2000)$处发射一枚速度为$300m/s$的导弹，朝向假目标飞行。现操纵无人机FY1以$120m/s$的速度朝假目标方向移动，并且在$1.5s$后投掷一枚烟幕弹，投掷后$3.6s$后起爆，M1发射位置已知，$M1(20000,0,2000)$本研究需要建立模型，计算出有效遮蔽时长。
\subsection{问题二}

无人机位置及导弹发射位置、速度均与问题一相同，在本问题中，无人机FY1携带一枚烟幕弹，在实现有效遮挡的前提下，确定无人机FY1的飞行方向、飞行速度、烟幕弹投放点、烟幕弹起爆点，尽可能延长有效遮蔽时长。
\subsection{问题三}

无人机位置及导弹发射位置、速度均与问题一相同，在本问题中，无人机FY1可携带3枚烟幕弹，且无人机FY1可在投掷第一枚烟幕弹后可以继续移动，投掷第一枚和第二枚烟幕干扰弹的间隔不得少于$1s$，本问题需要我们建立模型，确定FY1的飞行方向、飞行速度、烟幕干扰弹投放点、烟幕干扰弹起爆点，尽可能延长有效遮蔽时长。
\subsection{问题四}

本问题可调用无人机FY1、FY2、FY3，且每架无人机均可携带1枚烟幕弹，3架无人机位置坐标已给出，分别为：\textit{FY1(17800,0,1800), FY2(12000,1400,1400), FY3(6000,-3000,700)}其他条件与问题三相同，本问题需要我们建立模型，确定各无人机的飞行方向、飞行速度、烟幕干扰弹投放点、烟幕干扰弹起爆点，尽可能延长有效遮蔽时长。
\subsection{问题五}

本问题可调用无人机FY1、FY2、FY3、FY4、FY5，且每架无人机均可携带3枚烟幕弹，5架无人机位置坐标已给出，分别为：\textit{FY1(17800,0,1800), FY2(12000,1400,1400), FY3(6000,-3000,700)，FY4(11000,2000,1800)}同时对来自敌人的3枚导弹进行干扰，3枚导弹分别从$(20000,0,2000),$$(19000,600,2100),(18000,-600,2100)$朝向假目
标方向发射，其他条件与问题三相同。本问题需要我们建立模型，确定各无人机的飞行方向、飞行速度、烟幕干扰弹投放点、烟幕干扰弹起爆点，尽可能延长有效遮蔽时长。

\section{符号说明}

\begin{table}[H]
\centering
\caption{符号说明表}
\begin{tabular}{|c|l|}
\hline
符号 & 含义 \\
\hline
$\Delta t$ & 烟幕弹引信时间 \\
$t$ & 有效遮蔽时长 \\
$D$ & 烟幕弹 \\
$d$ & 烟幕团球心距轨迹面距离 \\
$v$ & 速度 \\
$O$ & 坐标原点（假目标） \\
$C$ & 真目标 \\
\hline
\end{tabular}
\end{table}

\section{问题分析}
本研究限制条件较多，涉及到多个物理量的计算，且各个物理量之间存在较强的关联性，其中存在多组函数关系。为方便后续问题的研究分析，现对有效遮蔽时长模型进行分析。

\begin{itemize}
    \item 简化模型：本研究对初始数据进行分析，发现无人机投掷烟雾弹位置应该均为离真假目标较远处，以无人机FY1的投掷位置为例，投掷位置距离假目标$17800m$，距离真目标$17600m$，真假目标距离较近，在真目标、假目标和无人机投掷连线的夹角小于$3^\circ$因此本研究在离真目标远距离投弹的情况下，真目标和假目标可以视为重合的质点，坐标为$(0,200,0)$。
    \item 有效遮挡的几何模型:在本研究中，导弹的飞行轨迹始终为指向原点的直线，现在我们对有效遮挡时的几何情况进行探讨。发现在导弹飞行过程中，若真目标处于烟幕团的投影范围内，则认为真目标被有效遮挡。表现为：\textit{导弹与真目标的视线线段穿过球形烟幕团}。导弹轨迹与水平面的夹角为$\theta$，定义导弹轨迹与其在水平面上的投影所在的平面为轨迹面，烟幕团球心距轨迹面距离为$d$，则有效遮挡的条件为$d<10$，所得到的有效遮挡长度为：
    \begin{center}
        $\displaystyle \frac{2\sqrt{10^2-d^2}}{\cos\theta}$
    \end{center}
    \item 有效遮挡时长的计算：在本研究中，导弹的飞行速度为$300m/s$，烟幕团下落速度为$3m/s$，则有效遮挡时长为：
\end{itemize}
\subsection{问题一分析}
在本问题中，各物理量均已给出，本题是一道结合题中给出物理量进行计算的题目。本研究采用解析几何与运动学原理建立出导弹轨迹模型和烟幕有效遮挡模型，并联立得到其综合的有效遮挡时长模型现已知导弹的轨迹方程为：$\begin{cases}
    y = 0 \\
    z = 10x
\end{cases}$
通过观察题目不难知道，无人机FY1 ,导弹M1,假目标T1,真目标T2均在同一平面上，且该平面为轨迹面，因此可将问题简化为二维问题进行分析，我们只需分析各物理量在$XOZ$平面上的运动投影即可。

\textit{真假目标，无人机FY1,导弹M1,导弹M1运动轨迹示意图:}


无人机移动策略已知，现可计算出烟幕弹投掷位置为$P_0(17620,0,1620)$，投掷时间为$t_1 = 1.5s$烟幕弹起爆位置为$P_1(17188,0,1735.2)$，引信时间$\Delta t$为$3.6s$，在引信时间内，烟幕弹作平抛运动，加速度为$g = (0,0,-10)$$m/s^2$，则烟幕弹起爆时刻$t_2 = t_1 + \Delta t = 5.1s$，烟幕团有效持续时间为$(5.1s \sim25.1s)$

\begin{itemize}
    \item 已知导弹M1运动轨迹与水平面的夹角$\theta_1 = \arctan{\frac{2000}{20000}} = 5.71^\circ$，则$\cos\theta_1 = 0.995$。
    \item 导弹M1运动轨迹分析：现可计算出导弹M1的运动轨迹方程为：$\begin{cases}
        x = 20000 - 300 \cos\theta_1 t \\
        y = 0 \\
        z = 2000 - 30 \sin \theta_1t
    \end{cases}$
    \item 无人机FY1运动轨迹分析：现可计算出无人机FY1的运动轨迹方程为：$\begin{cases}
        x = 17800 - 120t \\
        y = 0 \\
        z = 1800 
    \end{cases}$
    \item 烟幕弹作平抛运动飞行轨迹分析:$\begin{cases}
        x = 17620 - 120(t - 1.5) \\
        y = 0 \\
        z = 1800  - 5(t - 1.5)^2 \\
        t \in [1.5,5.1]
    \end{cases}$
    \item 烟幕团球心做匀速运动轨迹分析:\[
\mathbf{r}(t)=\left(
17800 - v_{FY1}\big(t_1+ \Delta t)
0.1800 - \tfrac{1}{2}g\,\Delta t^{2} - 3(t - t_1 - \Delta t)
\right),
\qquad t \ge t_1 + \Delta t
\]
    \item 其核心判断有效遮挡的逻辑在于：通过将烟幕团的球形运动轨迹函数与导弹M1的飞行轨迹函数进行联立求解，进而精确计算出二者的交点位置和对应时刻，从而进一步推导出导弹在烟幕团内的运动区间，并据此得到有效遮挡的持续时长。
\end{itemize}

\subsection{问题二分析}
%偏导求出驻点，代入黑塞矩阵判断极大值或极小值点
本问题为问题一的延续，区别在与无人机FY1飞行方向、飞行速度、烟幕弹投放点、烟幕弹起爆点均由研究者决定，因此本问题是一个多变量最优化问题，本研究决定结合数学分析知识为尽可能延长有效遮蔽时长，本研究通过对各变量进行整合，结合问题一中各物理量关于时间$t$的函数关系，建立出有效遮蔽时长$t$与各变量的函数关系式，进而通过对$t$求偏导数，计算出各变量的驻点，结合黑塞矩阵判断极大值或极小值点，选取极大值点各变量值作为最优策略。

\textit{分析各变量及限制条件}
\begin{itemize}
    \item 在对问题一的分析中，我们不难发现，当无人机FY1飞行轨迹位于轨迹面上时，烟幕团球心距轨迹面距离$d=0$，则有效遮挡长度最大，因此本研究认为FY1的最佳飞行方向与轨迹面重合，即平行于$X$轴方向。
    \item 在本问题的分析中，我们假设FY1的飞行速度$v_{FY1}$为$[70,140]m/s$，无人机FY1于$t_1$时刻投掷烟幕弹，引信时间$\Delta t$和无人机飞行方向$\aleph$。由此，我们得出决策所涉及到的四个变量$v_{FY1},t_1,\Delta t,\aleph$。
    \item 在联立各物理量函数式得到全过程模型后，我们对有效遮挡时长$t$分别对$v_{FY1},t_1,\Delta t$求偏导数，计算出各变量的驻点，即遮蔽时长对各变量偏导值为0的点，黑塞矩阵代入驻点的各个二阶偏导值，通过黑塞矩阵的正定性判断，选取极大值点各变量值作为最优策略。
\end{itemize}

\subsubsection{简化运算模型}

需要特别指出的是，在本问题的场景分析中，部分变量的最优取值可以通过理论推导和直观观察直接确定，且这些变量的局部最优解即为全局最优解。例如，无人机FY1的飞行方向应与导弹轨迹面完全重合，即$\aleph = 0$，而无人机的飞行速度则应取其允许范围内的最大值$120m/s$。因此，在实际建模与求解过程中，我们可以将FY1的飞行方向和速度直接固定为上述最优值。这样，原本涉及飞行方向、飞行速度、烟幕弹投掷时间$t_1$和引信时间$\Delta t$的四变量最优化问题，
可以合理简化为仅对烟幕弹投掷时间$t_1$和引信时间$\Delta t$进行优化的二变量最优化问题。这一简化不仅降低了模型的复杂度，也有助于提升后续求解的效率和精度，为模型分析和参数优化提供了更为清晰的数学基础。

\subsubsection{函数偏导与极值点求解}
在得到有效遮挡时长$t$与烟幕弹投掷时间$t_1$和引信时间$\Delta t$的函数关系式后，我们对$t$分别对$t_1$和$\Delta t$求偏导数，计算出各变量的驻点，即遮蔽时长对各变量偏导值为0的点，黑塞矩阵代入驻点的各个二阶偏导值，通过黑塞矩阵的正定性判断，选取极大值点各变量值作为最优策略。


\subsection{问题三分析}
通过对问题三的研究分析，我们注意到，本问题与问题二的区别在于无人机FY1可携带3枚烟幕弹，且无人机FY1可在投掷第一枚烟幕弹后可以继续移动，投掷第一枚和第二枚烟幕干扰弹的间隔不得少于$1s$，因此本问题中，我们需要对无人机FY1的飞行方向、飞行速度、烟幕干扰弹投放点、烟幕干扰弹起爆点进行求解。为方便后续分析，我们定义三枚烟幕弹分别为$D_1,D_2,D_3$，其投掷时间分别为$t_1,t_2,t_3$，其引信时间分别为$\Delta t_1,\Delta t_2,\Delta t_3$。
本问题涉及物理量较多，数值较大，且各物理量间存在较强相关性，所列函数式复杂，存在一对多或多对一的函数关系，因此难以用数学分析法进行求解，本研究决定采用模拟退火算法进行求解。

\textit{模拟退火算法简介:}
\begin{itemize}
    \item 模拟退火算法是一种基于概率的全局优化算法，灵感来源于固体物理中的退火过程。其核心思想是通过模拟物质在高温下的原子运动，逐渐降低温度，使系统达到最低能量状态，从而找到全局最优解。
    \item 算法步骤：
    \begin{enumerate}
        \item 初始化：选择初始解和初始温度。
        \item 迭代过程：
        \begin{itemize}
            \item 在当前解的邻域中随机选择一个新解。
            \item 计算新解的目标函数值与当前解的目标函数值之差$\Delta E$。
            \item 如果新解更优（$\Delta E < 0$），则接受新解作为当前解。
            \item 如果新解不更优（$\Delta E \geq 0$），则以概率$P = e^{-\Delta E / T}$接受新解，其中$T$为当前温度。
        \end{itemize}
        \item 降低温度：根据预定的降温计划逐渐降低温度。
        \item 重复迭代过程直到满足终止条件（如达到最大迭代次数或温度低于某一阈值）。
    \end{enumerate}
    \item 优点：能够跳出局部最优，适用于复杂的非线性优化问题。
    \item 缺点：参数选择（如初始温度、降温速率）对结果影响较大，计算时间较长，所得结果不一定是全局最优解。
\end{itemize}

\subsection{问题四分析}

\subsection{问题五分析}
本问题中需要处理的物理关系十分复杂，涉及到较多的变量，变量间相关性研究十分复杂，且变量数值较大，难以用数学分析法进行求解，各物理量函数式冗长，难以分辨出各变量间的联系，因此本研究选用遗传算法对场景进行模拟，得出最优决策。
需要注意，本问题中，5架无人机和导弹不完全处于同一个平面上，因此本问题中，我们需要对各物理量在$XOY$,$XOZ$,$YOZ$三个平面上的投影进行分析，进而计算出各物理量的函数关系式。

\section{模型假设}

\subsection{问题一模型假设}
\subsection{假设条件}
\begin{itemize}
    \item 忽略空气阻力的影响。
    \item 重力加速度在计算中视为常数$g = 10m/s^2$。
    \item 烟幕弹爆炸后，烟幕团为规则球体，且爆炸后立刻形成球状烟幕团。
\end{itemize}
%todo动图
本研究基于解析几何与运动学基本原理，在得到导弹轨迹方程、无人机轨迹方程、烟幕弹投掷轨迹方程和烟幕团轨迹方程的基础上，运用解析几何知识，进行几何模型建模对烟幕的有效遮挡时长进行计算。以下为模型建立与计算步骤：

\subsubsection{有效遮挡的判定算法}

由先前的分析可知，导弹M1与真目标T2的视线线段穿过烟幕团的条件为：烟幕团球心距轨迹面距离$d<10$，在本题中，$d = 0$，满足条件。有效遮挡的几何图样为，导弹与真目标的视线线段穿过球形烟幕团，在解析几何上为：导弹轨迹方程与烟幕团球形轨迹方程有解，临界情况为：导弹轨迹方程与烟幕团球形轨迹方程有唯一解。
模型式如下：
\subsubsection{通过场景模拟计算出有效遮挡时长}
本研究使用Mthamatica对场景进行模拟，发现导弹会在烟幕弹起爆一段时间后进入烟幕团，并在烟幕团消散前飞出烟幕团，因此，本研究选取联立解方程组的方式，计算出烟幕团运动轨迹与导弹运动轨迹的交点，进而计算出有效遮挡时长。
\textit{场景模型模拟动图：}

\begin{itemize}
    \item 先计算烟幕团到达有效遮蔽预设点的时间，即圆形轨迹与导弹轨迹下端相切点$P_1$，此时时刻为$t_\text{遮蔽}$。
    \item 模拟观察到导弹M1会穿过烟幕团，因此我们联立烟幕团轨迹方程与导弹M1轨迹方程，计算出其交点$P_2,P_3$，则导弹M1进入烟幕团的时间$t_{\text{进入}}$为$P_2$对应的时刻，导弹M1飞出烟幕团的时间$t_{\text{飞出}}$为$P_3$对应的时刻。
    \item 导弹M1在烟幕团内飞行时间$t_{\text{进入}} \sim t_{\text{飞出}}$，则有效遮挡时长$t =(t_\text{遮蔽}- t_\text{进入}) + (t_{\text{飞出}} - t_{\text{进入}})$。
\end{itemize}
\subsection{问题二模型假设}
本研究基于解析几何与运动学基本原理，由问题一已经建立出导弹轨迹方程，在此基础上进行改进，建立得出函数关于烟幕弹投掷时间$t_1$，引信时间$\Delta t$的有效遮挡时长$t$的函数关系式。

$t = f(t_1 , \Delta t)$

\subsubsection{假设条件}
\begin{itemize}
    \item 忽略空气阻力的影响。
    \item 重力加速度在计算中视为常数$g = 10m/s^2$。
    \item 假设无人机没有反应延迟。
    \item 忽略风速对物理量的影响。
    \item 烟幕弹爆炸后，烟幕团为规则球体，且爆炸后立刻形成球状烟幕团。
\end{itemize}

现在我们对函数$t = f(t_1 , \Delta t)$进行求一阶偏导数，求出驻点坐标。
\[
\begin{cases}
\frac{\partial t}{\partial t_1} = 0 \\\\
\frac{\partial t}{\partial \Delta t} = 0
\end{cases}
\]
\subsection{问题三模型假设}

\subsubsection{退火算法参数设定}

\subsection{问题四模型假设}

\subsection{问题五模型假设}

\section{模型建立与求解}

\subsection{问题一模型求解}

本研究通过编写Mathematica代码，建立出无人机投掷烟幕弹直至烟幕弹遮挡失效全过程的数学模型。实现将各物理量的变化封装为函数，在满足有效遮挡的模型下，分段计算出有效遮挡时长。如下：

\subsubsection{烟幕团进入有效遮挡预设点时间$t_\text{遮蔽}$的计算}
烟幕弹起爆时间为$5.1s$但此时烟幕团并未到达有效遮蔽预设点，现计算烟幕团到达有效遮蔽预设点的时间$t_\text{遮蔽}$，即圆形轨迹与导弹轨迹下端相切点$P_1$，由代数计算得出$t_\text{遮蔽} = 7.21s$，即从$t=7.21s$时刻起，烟幕团开始对真目标进行有效遮蔽，直至导弹穿出烟幕团。

\subsubsection{联立解方程组计算出烟幕团运动轨迹与导弹运动轨迹的交点}
联立烟幕团轨迹方程与导弹M1轨迹方程，计算出其交点$P_2,P_3$，则导弹M1进入烟幕团的时间$t_{\text{进入}}$为$P_2$对应的时刻，导弹M1飞出烟幕团的时间$t_{\text{飞出}}$为$P_3$对应的时刻。由代数计算得出$t_{\text{进入}} = 9.38s,t_{\text{飞出}} = 9.45s$。

\subsubsection{计算出有效遮挡时长$t$}
则有效遮挡时长$t =(t_\text{遮蔽}- t_\text{进入}) + (t_{\text{飞出}} - t_{\text{进入}}) = (9.38s - 7.21s) + (9.45s - 9.38s) = 2.24s$。

\textit{综上所述，在问题一中，无人机FY1以$120m/s$的速度朝假目标方向移动，并且在$1.5s$后投掷一枚烟幕弹，投掷后$3.6s$后起爆，有效遮蔽时长为$2.24s$。}

\subsection{问题二模型求解}

\subsection{问题三模型求解}

\subsection{问题四模型求解}

\subsection{问题五模型求解}

\section{模型优缺点及展望}

\subsection{模型优点分析}

\subsection{模型缺点分析}

\subsection{模型展望}




\section*{附录}
\vspace{-1em}


\noindent

\end{document}
