\documentclass{article}
\usepackage[UTF8]{ctex}
\usepackage{mathtools}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{float}
\usepackage{tikz}
\usepackage{graphicx}
\usepackage{indentfirst} % 使首段也缩进
\usepackage{forest}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{setspace} % 添加以支持 spacing 环境
% ...existing code...
\usepackage{setspace} % 添加以支持 spacing 环境
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{caption}
\usepackage{enumitem} % 支持自定义 enumerate 样式
% ...existing code...
\lstset{
    backgroundcolor=\color{gray!10}, % 背景色
    basicstyle=\ttfamily\small,      % 代码字体
    keywordstyle=\color{blue},       % 关键字颜色
    commentstyle=\color{gray},       % 注释颜色
    stringstyle=\color{red!70!black},% 字符串颜色
    numbers=left,                    % 行号显示在左侧
    numberstyle=\tiny\color{gray},
    breaklines=true,                 % 自动换行
    frame=single,                    % 框架
    tabsize=4,
    language=Python
}
\setlength{\parindent}{2em} % 设置首行缩进为两个汉字宽度
\everymath{\displaystyle}
\title{{\fontsize{18pt}{\baselineskip}\selectfont 基于解析几何和模拟退火的烟雾弹掩护目标投放策略}}
\date{}
\begin{document}
\maketitle
\begin{center}
\section*{摘要}
\end{center}
\vspace{-1em}


\noindent

本研究综合运用解析几何、黎曼积分思想及现代智能优化算法，对无人机投掷烟幕弹的最优决策问题进行了系统建模与求解。首先，基于解析几何与运动学原理，建立了导弹、无人机、烟幕弹及烟幕团的空间轨迹模型，推导出有效遮挡的判定条件。针对不同问题场景，分别采用区块化搜索、黎曼积分和模拟退火等算法，对无人机飞行路径、投掷时机、烟幕弹引信时间等关键决策变量进行优化。通过全局搜索与局部精细调整相结合，实现了有效遮蔽时长的最大化。所建模型兼顾物理过程的精确性与算法的适应性。

针对问题一，采用解析几何方法，建立多组物理量方程并联立，利用Mathematica对完整场景进行模拟与求解。

针对问题二，将其转化为多变量最优化问题，分别采用黎曼积分算法和变量区块化搜索算法进行求解，并结合模拟退火算法提升全局最优解的搜索能力，获得近似最优决策。

针对问题三，在问题二的基础上扩展为三次决策，变量和计算量显著增加。本研究创新新性地将复杂的多变量问题转化为一元二次方程，通过对时间$T$根的存在情况，结合模拟退火算法，得出最优决策。

针对问题四，将单架无人机扩展为三架，变量和约束进一步增加。通过定性分析和模型扩展，探讨多无人机协同投放的最优策略。

针对问题五，面对极其复杂的多变量、多函数耦合优化问题，常规方法难以直接求解，本研究主要进行定性分析，为后续深入研究提供理论参考。
\noindent

\textbf{关键词：}\textit{解析几何}，\textit{有效遮挡判定函数}，\textit{区块化搜索}，\textit{模拟退火}，\textit{黎曼积分}，\textit{场景模拟}，\textit{根的判别式}



\section{问题复述}

\subsection{问题背景}

在军事上，烟雾弹是一种用于掩护特定保护目标的战术装备。该装备通常搭配假干扰目标进行使用。\textit{烟幕干扰弹通过释放大量烟雾，形成视觉屏障，阻挡敌方的视线，以达到保护真实目标的目的。}在本材料中，烟幕干扰弹由无人机进行投掷。敌人发射多枚朝向假目标速度为$300m/s$的导弹，而我方的任务是通过投掷烟雾弹来掩护真实目标。在材料中，假目标和真实目标均为静止目标。假目标的坐标位置和真实目标的坐标位置均已知，其中假目标位于坐标轴原点，真目标位于$(0,200,0)$处，真目标为半径$7m$高度$10m$的圆柱体。我方携带烟幕弹无人机的部署位置均已知。敌人发射导弹的时间和位置均已知。烟雾弹投掷后的一段时间后会产生烟雾，烟雾会在20秒内持续存在，形成一个以烟幕弹为圆心半径为10$m$的球形烟幕团，并且烟幕团会以$3 m/s$的速度匀速下落，
持续时间为20$s$。为实现对真实目标的有效掩护，我方需要合理规划烟雾弹的投掷位置和时间，对无人机进行合理的调动，以确保在敌人导弹飞行过程中，真实目标尽可能处于于烟幕团的掩护范围内。其中无人机的飞行速度和方向一旦确定后，在飞行过程中均不可更改，且无人机不能改变飞行高度。

\textit{初始模型坐标位置可视化:}

\subsection{问题一}

已知无人机FY1位于$(17800,0,1800)$处，现在敌人从$(20000,0,2000)$处发射一枚速度为$300m/s$的导弹，朝向假目标飞行。现操纵无人机FY1以$120m/s$的速度朝假目标方向移动，并且在$1.5s$后投掷一枚烟幕弹，投掷后$3.6s$后起爆，M1发射位置已知，$M1(20000,0,2000)$本研究需要建立模型，计算出有效遮蔽时长。
\subsection{问题二}

无人机位置及导弹发射位置、速度均与问题一相同，在本问题中，无人机FY1携带一枚烟幕弹，在实现有效遮挡的前提下，确定无人机FY1的飞行方向、飞行速度、烟幕弹投放点、烟幕弹起爆点，尽可能延长有效遮蔽时长。
\subsection{问题三}

无人机位置及导弹发射位置、速度均与问题一相同，在本问题中，无人机FY1可携带3枚烟幕弹，且无人机FY1可在投掷第一枚烟幕弹后可以继续移动，投掷第一枚和第二枚烟幕干扰弹的间隔不得少于$1s$，本问题需要我们建立模型，确定FY1的飞行方向、飞行速度、烟幕干扰弹投放点、烟幕干扰弹起爆点，尽可能延长有效遮蔽时长。
\subsection{问题四}

本问题可调用无人机FY1、FY2、FY3，且每架无人机均可携带1枚烟幕弹，3架无人机位置坐标已给出，分别为：\textit{FY1(17800,0,1800), FY2(12000,1400,1400), FY3(6000,-3000,700)}其他条件与问题三相同，本问题需要我们建立模型，确定各无人机的飞行方向、飞行速度、烟幕干扰弹投放点、烟幕干扰弹起爆点，尽可能延长有效遮蔽时长。鉴于本问题中存在多组一对多或多对一的物理量关系，情景复杂，因此本研究推荐采用遗传算法等智能算法模型。
\subsection{问题五}
本问题是在前述模型基础上的进一步复杂化与扩展。现假定可调用无人机FY1、FY2、FY3、FY4、FY5，每架无人机均可携带3枚烟幕弹，5架无人机的初始位置分别为：\textit{FY1(17800,0,1800), FY2(12000,1400,1400), FY3(6000,-3000,700), FY4(11000,2000,1800), FY5(8000,-2000,1200)}。同时，敌方共发射3枚导弹，发射点分别为$(20000,0,2000)$、$(19000,600,2100)$、$(18000,-600,2100)$，均朝向假目标方向飞行。其余条件与问题三保持一致。
本问题需要针对多无人机、多导弹、多烟幕弹的复杂耦合场景，建立高维多目标优化模型。由于变量数量和约束条件大幅增加，且各无人机、烟幕弹、导弹之间存在复杂的时空耦合关系，传统解析方法难以直接求解。本研究建议采用遗传算法、粒子群优化等智能优化算法，结合场景仿真，对多无人机协同投放策略进行全局搜索与局部精细调整。通过对各无人机投弹方案的联合优化，最大化所有导弹对真目标的总有效遮蔽时长。
\section{符号说明}
\begin{table}[H]
\centering
\caption{符号说明表}
\begin{tabular}{|c|l|}
\hline
符号 & 含义 \\
\hline
$\Delta t$ & 烟幕弹引信时间 \\
$T$ & 有效遮蔽时长 \\
$D$ & 烟幕弹 \\
$d$ & 烟幕团球心距轨迹面距离 \\
$v$ & 速度 \\
$O$ & 坐标原点（假目标） \\
$C$ & 真目标 \\
$G$ & 烟幕团圆心坐标 \\
\hline
\end{tabular}
\end{table}

\section{问题分析}
本研究限制条件较多，涉及到多个物理量的计算，且各个物理量之间存在较强的关联性，其中存在多组函数关系。为方便后续问题的研究分析，现对有效遮蔽时长模型进行分析。

\begin{itemize}
    \item 简化模型：本研究对初始数据进行分析，发现无人机投掷烟雾弹位置应该均为离真假目标较远处，以无人机FY1的投掷位置为例，投掷位置距离假目标$17800m$，距离真目标$17600m$，真假目标距离较近，在真目标、假目标和无人机投掷连线的夹角小于$3^\circ$因此本研究在离真目标远距离投弹的情况下，真目标和假目标可以视为重合的质点，坐标为$(0,200,0)$。
    \item 有效遮挡的几何模型:在本研究中，导弹的飞行轨迹始终为指向原点的直线，现在我们对有效遮挡时的几何情况进行探讨。发现在导弹飞行过程中，若真目标处于烟幕团的投影范围内，则认为真目标被有效遮挡。表现为：\textit{导弹与真目标的视线线段穿过球形烟幕团}。导弹轨迹与水平面的夹角为$\theta$，定义导弹轨迹与其在水平面上的投影所在的平面为轨迹面，烟幕团球心距轨迹面距离为$d$，则有效遮挡的条件为$d<10$，所得到的有效遮挡长度为：
    \begin{center}
        $\displaystyle \frac{2\sqrt{10^2-d^2}}{\cos\theta}$
    \end{center}
    \item 有效遮挡时长的计算：在本研究中，导弹的飞行速度为$300m/s$，烟幕团下落速度为$3m/s$，则有效遮挡时长为：
    \item 有效遮挡的空间条件：导弹与烟幕团中心的距离不超过有效遮挡半径
    \item 有效遮挡的时间条件：导弹飞行时间与烟幕团存在时间有交集
\end{itemize}

\textit{有效遮挡的判定函数(isoccluded)}：
\begin{itemize}
    \item 判定函数是本研究的核心，现对判定函数进行分析。判定函数的输入参数为：无人机飞行方向，无人机飞行速度，烟幕弹投掷时间，引信时长输出参数为：有效遮挡判定状态。
    \item 判定函数的逻辑：通过将烟幕团的球形运动轨迹函数与导弹的飞行轨迹函数进行联立求解，进而精确计算出二者的交点位置和对应时刻，从而进一步推导出导弹在烟幕团内的运动区间，并据此得到有效遮挡的持续时长。
    \item 总的有效遮蔽时长为各个有效遮蔽时长之和
\end{itemize}
\subsection{问题一分析}
在本问题中，各物理量均已给出，本题是一道结合题中给出物理量进行计算的题目。本研究采用解析几何与运动学原理建立出导弹轨迹模型和烟幕有效遮挡模型，并联立得到其综合的有效遮挡时长模型现已知导弹的轨迹方程为：$\begin{cases}
    y = 0 \\
    z = 10x
\end{cases}$
通过观察题目不难知道，无人机FY1 ,导弹M1,假目标T1,真目标T2均在同一平面上，且该平面为轨迹面，因此可将问题简化为二维问题进行分析，我们只需分析各物理量在$XOZ$平面上的运动投影即可。

\textit{真假目标，无人机FY1,导弹M1,导弹M1运动轨迹示意图:}


无人机移动策略已知，现可计算出烟幕弹投掷位置为$P_0(17620,0,1620)$，投掷时间为$t_1 = 1.5s$烟幕弹起爆位置为$P_1(17188,0,1735.2)$，引信时间$\Delta t$为$3.6s$，在引信时间内，烟幕弹作平抛运动，加速度为$g = (0,0,-10)$$m/s^2$，则烟幕弹起爆时刻$t_2 = t_1 + \Delta t = 5.1s$，烟幕团有效持续时间为$(5.1s \sim25.1s)$

\begin{itemize}
    \item 已知导弹M1运动轨迹与水平面的夹角$\theta_1 = \arctan{\frac{2000}{20000}} = 5.71^\circ$，则$\cos\theta_1 = 0.995$。
    \item 导弹M1运动轨迹分析：现可计算出导弹M1的运动轨迹方程为：$\begin{cases}
        x = 20000 - 300 \cos\theta_1 t \\
        y = 0 \\
        z = 2000 - 30 \sin \theta_1t
    \end{cases}$
    \item 无人机FY1运动轨迹分析：现可计算出无人机FY1的运动轨迹方程为：$\begin{cases}
        x = 17800 - 120t \\
        y = 0 \\
        z = 1800 
    \end{cases}$
    \item 烟幕弹作平抛运动飞行轨迹分析:$\begin{cases}
        x = 17620 - 120(t - 1.5) \\
        y = 0 \\
        z = 1800  - 5(t - 1.5)^2 \\
        t \in [1.5,5.1]
    \end{cases}$
    \item 烟幕团球心做匀速运动轨迹分析:\[
\mathbf{r}(t)=\left(
17800 - v_{FY1}\big(t_1+ \Delta t)
0.1800 - \tfrac{1}{2}g\,\Delta t^{2} - 3(t - t_1 - \Delta t)
\right),
\qquad t \ge t_1 + \Delta t
\]
    \item 其核心判断有效遮挡的逻辑在于：通过将烟幕团的球形运动轨迹函数与导弹M1的飞行轨迹函数进行联立求解，进而精确计算出二者的交点位置和对应时刻，从而进一步推导出导弹在烟幕团内的运动区间，并据此得到有效遮挡的持续时长。
\end{itemize}

\subsection{问题二分析}
%偏导求出驻点，代入黑塞矩阵判断极大值或极小值点
本问题为问题一的延续，区别在与无人机FY1飞行方向、飞行速度、烟幕弹投放点、烟幕弹起爆点均由研究者决定，因此本问题是一个多变量最优化问题，本研究决定结合数学分析知识为尽可能延长有效遮蔽时长。
\subsubsection{黎曼积分算法}
本研究决定采用微分法，由题目材料可知，烟幕团的存在时间为20$s$，烟幕团的运动轨迹为匀速直线运动，且烟幕团的运动轨迹与导弹M1的飞行轨迹均为直线，因此本研究决定采用黎曼和积分的思想，将烟幕弹起爆后的$20s$内分为多个细分区间，以每一区间的中点作为区间\textit{代表点}，以\textit{代表点}的有效遮蔽状况代表全区间，建立出有效遮蔽时长的积分模型，从烟幕弹起爆时刻开始直至20s后，判断每个区间的有效遮蔽状况，进而计算出总的有效遮蔽时长。
本研究采用退火算法取得各变量的近似最优解，进而计算出有效遮蔽时长的近似最优解。

\subsubsection{变量区块化搜索算法}
本研究将变量
\textit{分析各变量及限制条件}
\begin{itemize}
    \item 在对问题一的分析中，我们不难发现，当无人机FY1飞行轨迹位于轨迹面上时，烟幕团球心距轨迹面距离$d=0$，则有效遮挡长度最大，因此本研究认为FY1的最佳飞行方向与轨迹面重合，即平行于$X$轴方向。
    \item 在本问题的分析中，我们假设FY1的飞行速度$v_{FY1}$为$[70,140]m/s$，无人机FY1于$t_1$时刻投掷烟幕弹，引信时间$\Delta t$和无人机飞行方向$\aleph$。由此，我们得出决策所涉及到的四个变量$v_{FY1},t_1,\Delta t,\aleph$。
    \item 在联立各物理量函数式得到全过程模型后，我们对各变量进行定性研究，发现各变量间存在较强的相关性，且各变量均对有效遮蔽时长有影响参差不齐，不同变量对，因此本研究决定对各变量进行有限枚举，进而计算出不同变量组合下的有效遮蔽时长，最终选取有效遮蔽时长最长的变量组合作为最优解。
    \item 起爆时间$\Delta t$的取值范围为$[0.1s,10s]$，步长为$0.1s$，则$\Delta t$有100种取值。同理，$t_1$的取值范围为$[0s,20s]$，步长为$0.1s$，则$t_1$有200种取值。$v_{FY1}$的取值范围为$[70m/s,140m/s]$，步长为$1m/s$，则$v_{FY1}$有71种取值。$\aleph$的取值范围为$[0^\circ,360^\circ]$，步长为$1^\circ$，则$\aleph$有360种取值。
\end{itemize}

\textit{模型简化与区块化搜索}
在对问题一的分析中，我们不难发现，当无人机FY1飞行轨迹位于轨迹面上时，烟幕团球心距轨迹面距离$d=0$，则有效遮挡长度最大，因此本研究认为FY1的最佳飞行方向与轨迹面重合，即平行于$X$轴方向。因此本问题可简化为三变量最优化问题。现对各变量进行区块化搜索。
为求解该多变量最优化问题，本研究将决策变量$v_{FY1}$、$t_1$、$\Delta t$、$\aleph$视为4维欧几里得空间$\mathbb{R}^4$中的坐标轴，对该空间进行区块化分割（即网格剖分），将每个变量的取值区间离散化为有限步长，形成4维网格在简化后转化为3维网格空间。通过遍历每个网格节点，计算对应的有效遮蔽时长，初步筛选出表现优异的变量组合。随后，针对初步结果表现较优的局部区域，进一步细化网格分割，缩小变量取值范围，重复上述过程，实现对4维空间的多轮递进式区块化搜索，最终获得最优解。该方法兼顾全局搜索能力与局部精细优化，能够有效应对变量间复杂的非线性耦合关系。


\subsection{问题三分析}
通过对问题三的研究分析，我们注意到，本问题与问题二的区别在于无人机FY1可携带3枚烟幕弹，且无人机FY1可在投掷第一枚烟幕弹后可以继续移动，投掷第一枚和第二枚烟幕干扰弹的间隔不得少于$1s$，因此本问题中，我们需要对无人机FY1的飞行方向、飞行速度、烟幕干扰弹投放点、烟幕干扰弹起爆点进行求解。为方便后续分析，我们定义三枚烟幕弹分别为$D_1,D_2,D_3$，其投掷时间分别为$t_1,t_2,t_3$，其引信时间分别为$\Delta t_1,\Delta t_2,\Delta t_3$。
本问题涉及物理量较多，数值较大，且各物理量间存在较强相关性，所列函数式复杂，存在一对多或多对一的函数关系，因此难以用数学分析法进行求解，本研究决定采用模拟退火算法进行求解。

与前两问不同，本问题中存在3组连续的烟幕弹投掷决策变量，分别为每枚烟幕弹的投掷时间$t_i$和引信时间$\Delta t_i$（$i=1,2,3$），以及无人机FY1的飞行速度$v_{FY1}$和飞行方向$\aleph$。这些变量共同决定了烟幕团在空间中的分布和运动轨迹，进而影响有效遮蔽时长的计算。由于变量间存在复杂的非线性耦合关系，且每组变量均对最终结果有显著影响，因此本问题可视为一个高维、多峰值的非线性优化问题。

\textit{模拟退火算法简介:}
\begin{itemize}
    \item 模拟退火算法是一种基于概率的全局优化算法，灵感来源于固体物理中的退火过程。其核心思想是通过模拟物质在高温下的原子运动，逐渐降低温度，使系统达到最低能量状态，从而找到全局最优解。
    \item 算法步骤：
    \begin{enumerate}
        \item 初始化：选择初始解和初始温度。
        \item 迭代过程：
        \begin{itemize}
            \item 在当前解的邻域中随机选择一个新解。
            \item 计算新解的目标函数值与当前解的目标函数值之差$\Delta E$。
            \item 如果新解更优（$\Delta E < 0$），则接受新解作为当前解。
            \item 如果新解不更优（$\Delta E \geq 0$），则以概率$P = e^{-\Delta E / T}$接受新解，其中$T$为当前温度。
        \end{itemize}
        \item 降低温度：根据预定的降温计划逐渐降低温度。
        \item 重复迭代过程直到满足终止条件（如达到最大迭代次数或温度低于某一阈值）。
    \end{enumerate}
    \item 优点：能够跳出局部最优，适用于复杂的非线性优化问题。
    \item 缺点：参数选择（如初始温度、降温速率）对结果影响较大，计算时间较长，所得结果不一定是全局最优解。
\end{itemize}
\paragraph{算法伪代码}
\begin{algorithm}[H]
\caption{模拟退火算法（SA）求解烟幕投放优化}
\begin{algorithmic}[1]
\State 初始化：选择初始解 $x_0$、初始温度 $T_0$、降温因子 $\alpha\in(0,1)$、内循环次数 $L$、最大迭代数 $N$
\For{$k=0,\dots,N-1$}
  \For{$j=1,\dots,L$}
    \State 在当前解 $x$ 的邻域随机生成候选解 $x'$，对硬约束投影修正
    \State 计算目标能量 $E(x')=-T_{\mathrm{cover}}(x')+P_{\mathrm{penalty}}(x')$
    \State $\Delta E=E(x')-E(x)$
    \If{$\Delta E<0$} 接受 $x\leftarrow x'$
    \Else \State 以概率 $\exp(-\Delta E/T_k)$ 接受 $x\leftarrow x'$
    \EndIf
  \EndFor
  \State 降温 $T_{k+1}\leftarrow \alpha T_k$
  \If{满足终止条件（温度极小或无改进）} \textbf{break}
  \EndIf
\EndFor
\State 输出最优解 $x^*$
\end{algorithmic}
\end{algorithm}

为方便计算，我们将本问题抽象为几何问题，通过判断二次函数根的判别式$\Delta$的值的情况，简化有效遮蔽的判断模型，并且通过求根公式计算出总的有效遮蔽时长$T$
本研究通过对所有变量方程式进行联立，得出最简单形式的限制条件，尽可能地将问题转化为单目标优化问题，把变量限制在较小范围内，进而使用模拟退火算法对问题进行求解，得出近似最优解。

\subsection{问题四分析}
本问为问题三的深化问题，区别在于本问题中可调用无人机FY1、FY2、FY3，与问题三相比，本问题研究的变量更多，是问题3的3倍，因此本问题的复杂度更高。
本问题要考虑到3架无人机的有效遮蔽时长的叠加效应，且3架无人机的飞行轨迹均不可相交，因此本问题中，3架无人机投掷策略的局部最优解之和不一定是全局最优解，因此本问题中，我们需要对3架无人机的投掷策略进行整体优化。

\subsection{问题五分析}
本问题中需要处理的物理关系十分复杂，涉及到较多的变量，变量间相关性研究十分复杂，且变量数值较大，难以用数学分析法进行求解，各物理量函数式冗长，难以分辨出各变量间的联系，因此本研究选用遗传算法对场景进行模拟，得出最优决策。
需要注意，本问题中，5架无人机和导弹不完全处于同一个平面上，因此本问题中，我们需要对各物理量在$XOY$,$XOZ$,$YOZ$三个平面上的投影进行分析，进而计算出各物理量的函数关系式。

\section{模型假设}

\textit{假设条件}
\begin{itemize}
    \item 忽略空气阻力的影响。
    \item 重力加速度在计算中视为常数$g = 10m/s^2$。
    \item 假设无人机没有反应延迟。
    \item 忽略风速对物理量的影响。
    \item 烟幕弹爆炸后，烟幕团为规则球体，且爆炸后立刻形成球状烟幕团。
\end{itemize}
\subsection{状态函数的模型假设}
将 $L(u)$ 代入球体方程，得到一元二次方程
\[
A u^2 + B u + C_0 = 0,
\]
其中
\[
A = \|C - M(t)\|^2, \quad
B = 2\,(C - M(t)) \cdot (M(t) - G(t)), \quad
C_0 = \|M(t) - G(t)\|^2 - R^2.
\]

判别式为
\[
\Delta = B^2 - 4AC_0.
\]

若满足以下条件，则视为有效遮挡：
1. 烟幕处于有效期：
\[
t_{\text{起爆}} \leq t \leq t_{\text{起爆}} + 20,
\]
2. 二次方程存在解 $u \in [0,1]$，即
\[
\Delta \geq 0 \quad \text{且} \quad u = 1.
\]

\textit{函数原理}
所以 \texttt{isoccluded()} 的逻辑就是：

\begin{enumerate}[leftmargin=*,label=\arabic*.]
  \item 检查当前时间是否在烟幕有效期；
  \item 根据当前云团球心 \(C(t)\) 构造二次方程；
  \item 计算判别式，解是否落在 \([0,1]\)；
  \item 返回 \texttt{true}/\texttt{false}。
\end{enumerate}

这就是 \textbf{基于几何判别式的遮挡判定方法}。

\subsection{问题一模型假设}

%todo动图
本研究基于解析几何与运动学基本原理，在得到导弹轨迹方程、无人机轨迹方程、烟幕弹投掷轨迹方程和烟幕团轨迹方程的基础上，运用解析几何知识，进行几何模型建模对烟幕的有效遮挡时长进行计算。以下为模型建立与计算步骤：

\subsubsection{基于解析几何的有效遮挡判定算法}

由先前的分析可知，导弹M1与真目标T2的视线线段穿过烟幕团的条件为：烟幕团球心距轨迹面距离$d<10$，在本题中，$d = 0$，满足条件。有效遮挡的几何图样为，导弹与真目标的视线线段穿过球形烟幕团，在解析几何上为：导弹轨迹方程与烟幕团球形轨迹方程有解，临界情况为：导弹轨迹方程与烟幕团球形轨迹方程有唯一解，即为根的判别式$\Delta  = 0$。
模型式如下：
\subsubsection{通过场景模拟计算出有效遮挡时长}
本研究使用Mthamatica对场景进行模拟，发现导弹会在烟幕弹起爆一段时间后进入烟幕团，并在烟幕团消散前飞出烟幕团，因此，本研究选取联立解方程组的方式，计算出烟幕团运动轨迹与导弹运动轨迹的交点，进而计算出有效遮挡时长。
\textit{场景模型模拟动图：}

\begin{itemize}
    \item 先计算烟幕团到达有效遮蔽预设点的时间，即圆形轨迹与导弹轨迹下端相切点$P_1$，此时时刻为$t_\text{遮蔽}$。
    \item 模拟观察到导弹M1会穿过烟幕团，因此我们联立烟幕团轨迹方程与导弹M1轨迹方程，计算出其交点$P_2,P_3$，则导弹M1进入烟幕团的时间$t_{\text{进入}}$为$P_2$对应的时刻，导弹M1飞出烟幕团的时间$t_{\text{飞出}}$为$P_3$对应的时刻。
    \item 导弹M1在烟幕团内飞行时间$t_{\text{进入}} \sim t_{\text{飞出}}$，则有效遮挡时长$t =(t_\text{遮蔽}- t_\text{进入}) + (t_{\text{飞出}} - t_{\text{进入}})$。
\end{itemize}
\subsection{问题二模型假设}
本研究基于解析几何与运动学基本原理，由问题一已经建立出导弹轨迹方程，在此基础上进行改进，建立得出函数关于烟幕弹投掷时间$t_1$，引信时间$\Delta t$，$无人机速度 v_\text{无人机}$$无人机运动方向与x轴的夹角\aleph$的有效遮挡时长$t$的函数关系式。


\subsubsection{假设条件}
\begin{itemize}
    \item 忽略空气阻力的影响。
    \item 重力加速度在计算中视为常数$g = 10m/s^2$。
    \item 假设无人机没有反应延迟。
    \item 忽略风速对物理量的影响。
    \item 烟幕弹爆炸后，烟幕团为规则球体，且爆炸后立刻形成球状烟幕团。
\end{itemize}
\subsubsection{黎曼积分算法}
核心公式为:$T = \int_{t_\text{起爆}}^{t_\text{起爆+20}}isoccluded(t_1,\Delta t , \alpha , v_\text{无人机})dt$在代码实现层面，我们将烟幕弹起爆后的$20s$内分为多个细分区间，以每一区间的中点作为区间\textit{代表点}，以\textit{代表点}的有效遮蔽状况代表全区间，建立出有效遮蔽时长的积分模型，从烟幕弹起爆时刻开始直至20s后，判断每个区间的有效遮蔽状况，即等效为对烟幕有效时间的状态积分进而计算出总的有效遮蔽时长。
\subsubsection{变量区块化搜索算法}
\begin{itemize}
    \item 无人机FY1的飞行方向与轨迹面重合，速度为$120m/s$。其方程为：$\begin{cases}
        x = 17800 - 120t \\
        y = 0 \\
        z = 1800
    \end{cases}$
    \item 烟幕弹投掷时间为$t_1$，引信时间为$\Delta t$，则烟幕弹起爆时间$t_2 = t_1 + \Delta t$，在引信时间内，烟幕弹作平抛运动，加速度为$g = (0,0,-10)$$m/s^2$，则烟幕弹起爆位置为$P_1(17800 - 120t_1,0,1800 - 5\Delta t^2)$，烟幕团有效持续时间为$(t_2 \sim t_2 + 20s)$
    \item 烟幕团球心做匀速运动轨迹分析:设气团球心位置为$P_{smoke}$。其爆炸位置坐标为$((2000-120(t_1 + \Delta t)),0,2000-5 \Delta t^2)$其后续移动到预设有效遮蔽点的坐标是$((2000-120(t_1 + \Delta t)),0,2000-5 \Delta t^2)$
    \item 通过比对观察分析，发现各变量间存在较强的相关性，且各变量均对有效遮蔽时长有影响参差不齐，不同变量对有效遮蔽时长的影响程度不同，因此本研究决定对各变量进行有限枚举，进而计算出不同变量组合下的有效遮蔽时长，发现在$无人机FY1运动方向\alpha$最终选取有效遮蔽时长最长的变量组合作为最优解。
\end{itemize}

\begin{itemize}
    \item 设 FY1 的飞行方向与 $x$ 轴正方向的旋转角为 $\alpha$（逆时针为正），$\alpha\in[0,2\pi]$。则在时刻 $t$，FY1 的位置为
    \[
    \mathbf{B}'(t) = \bigl(17800 + v_{FY1} t \cos\alpha,\;\; v_{FY1} t \sin\alpha,\;\; 1800\bigr).
    \]
    \item 在时刻 $t' = t'$ 投掷烟幕弹，投掷后弹体在 $t \ge t'$ 的位置（以无人机在 $t'$ 的位置为初始）为
    \[
    \mathbf{B}''(t) = \mathbf{r}_u(t') + \bigl(-v_{FY1} \cos\alpha\, (t-t'),\;\; -v_{FY1} \sin\alpha\, (t-t'),\;\; -\tfrac{1}{2}g\, (t-t')^2\bigr).
    \]
    \item 若引信时间为 $\Delta t$，起爆时刻 $t_{\mathrm{exp}} = t' + \Delta t$，则在 $t \ge t_{\mathrm{exp}}$ 时烟幕团球心位置为
    \[
    \mathbf{B}'''(t) = \mathbf{p}_{\mathrm{exp}} + \bigl(-v_{FY1} \cos\alpha\, (t-t_{\mathrm{exp}}),\;\; -v_{FY1} \sin\alpha\, (t-t_{\mathrm{exp}}),\;\; -v_s\, (t-t_{\mathrm{exp}})\bigr),
    \]
    其中
    \[
    \mathbf{p}_{\mathrm{exp}} = \mathbf{r}_u(t') + \bigl(-v_{FY1} \cos\alpha\, \Delta t,\;\; -v_{FY1} \sin\alpha\, \Delta t,\;\; -\tfrac{1}{2}g\, \Delta t^2\bigr)
    \]
    为起爆位置，$v_s$ 为烟幕下落速度。
    \item 取常用数值 $g = 10\,\mathrm{m/s^2}$，$v_s = 3\,\mathrm{m/s}$，可写成简化形式
    \[
    \mathbf{B}'''(t) = \Bigl(17800 + v_{FY1}(t' + \Delta t)\cos\alpha,\;\; v_{FY1} t' \sin\alpha,\;\; 1800 - 5\Delta t^{2} - 3\bigl(t - t' - \Delta t\bigr)\Bigr).
    \]
    \item 导弹 $M_1$ 在时刻 $t$ 的位置若记为 $\mathbf{A}'(t)$，导弹速率为 $v_{M1}$，轨迹与水平面的夹角为 $\theta_1$，则
    \[
    \mathbf{A}'(t) = \bigl(20000 - v_{M1} \cos\theta_1\, t,\;\; 0,\;\; 2000 - v_{M1} \sin\theta_1\, t\bigr).
    \]
\end{itemize}
% ...existing code...
本研究通过对问题一模型中的常量物理量用变量替代，建立出各物理量关于变量的函数关系式，进而通过网格搜索法对变量进行取值，计算出不同变量组合下的有效遮蔽时长，最终选取有效遮蔽时长最长的变量组合作为最优解。

\subsubsection{两算法对比及相互验证}
黎曼积分算法核心是通过有效遮挡状态函数的积分来计算总的有效遮挡时长，适用于连续时间段内的遮挡情况评估，能够细致反映烟幕弹在其有效期内对导弹的遮挡效果。而变量区块化搜索算法则通过离散化的变量取值组合，评估不同策略下的遮挡效果，适用于多变量优化问题，能够帮助识别出最佳的投掷和飞行参数组合。
两种方法各有侧重，前者注重时间连续性的遮挡评估，后者强调参数空间的全局搜索。通过对比两种方法的结果，可以相互验证其有效性和鲁棒性，确保所选策略在实际应用中具有较强的适应性和可靠性。
\subsection{问题三模型假设}
% ...existing code...
本研究中将$无人机移动方向角\alpha = 0$时视为全局最优解，比较合理。

不难观察出，本题限制条件繁杂，各变量关系混乱，难以通过微分方程分离变量。因此本研究对几何模型进行推导简化，推导过程如下。

\begin{itemize}
    \item 导弹轨迹面为$XOZ$平面，因此本问题将三维立体模型降为二维平面上进行研究。
    \item 导弹轨迹方程为$y = \frac{1}{10}x$,鉴于烟幕团半径为10$m$，因此本研究定义距离导弹轨迹10$m$的轨迹平行线为\textit{最佳爆炸线}同时也是\textit{有效遮挡初始直线}，函数方程为$y = \frac{1}{10}x + \sqrt{101}$，定义$y = \frac{1}{10}x - \sqrt{101}$
    为\textit{有效遮挡终止线}
    \item 本研究采用模拟退火算法，因此可以在计算过程中把自变量$t_1 , \Delta t , v_\text{无人机}$视为已知量。通过联立方程组，我们最终解出一个关于$T$的一元二次方程组。因此本问题转化为对遮挡时长$T$的根的存在情况。
\end{itemize}

现在对根的判别式的不同情况进行分类讨论：
\begin{itemize}
    \item 当$\Delta < 0$时，在几何意义上为，导弹始终没有穿过烟幕团，这可以分为两种情况进行讨论:\begin{itemize}
        \item 导弹全程落后于烟幕团，有效遮蔽时长为理论最大值:$\frac{20}{3\cos \theta}$
        \item 导弹全程领先于烟幕团，有效遮蔽时长为0
    \end{itemize}
    \item 当$\Delta \ge 0$时，几何意义上为，导弹在某一时间段穿过烟幕弹，此时我们代入一元二次函数的求根公式即可计算出有效遮蔽时长，现对该情况进行深入讨论
\end{itemize}

\textit{$\Delta \ge 0$时刻的理论推导}：
设$t_{start}$为烟幕开始遮蔽航线时刻，$t_{end}$为烟幕结束遮蔽航线结束时间，$t_{breach}$为导弹穿出烟幕的时间（可能不存在）

当$\Delta \ge 0$时，导弹有穿入与穿出时刻，此时导弹距离烟幕中心的距离为$r$，换言之，导弹航线上存在一点（即导弹）距离烟幕中心距离恰好为烟幕半径$r$，说明该时刻烟幕正在遮挡航线，从而有$t_{start} \le t_{breach} \le t_{end}$

因为$\Delta$的函数式已经在代码中体现，且该公式较为繁杂，故不在论文中详细推导。
\subsection{问题四模型假设}
用微分方程尽可能将变量分离，用遗传算法等智能算法进行模拟。本研究在问题三的基础上，同样将复杂的判段条件转变为代数求解问题，但在问题三模型的基础上加入无人机飞行方向这一新变量

\subsection{问题五模型假设}
用微分方程尽可能将变量分离，用遗传算法等智能算法进行模拟。

\section{模型建立与求解}

\subsection{问题一模型求解}

本研究通过编写Mathematica代码，建立出无人机投掷烟幕弹直至烟幕弹遮挡失效全过程的数学模型。实现将各物理量的变化封装为函数，在满足有效遮挡的模型下，分段计算出有效遮挡时长。如下：

\subsubsection{烟幕团进入有效遮挡预设点时间$t_\text{遮蔽}$的计算}
烟幕弹起爆时间为$5.1s$但此时烟幕团并未到达有效遮蔽预设点，现计算烟幕团到达有效遮蔽预设点的时间$t_\text{遮蔽}$，即圆形轨迹与导弹轨迹下端相切点$P_1$，由代数计算得出$t_\text{遮蔽} = 7.21s$，即从$t=7.21s$时刻起，烟幕团开始对真目标进行有效遮蔽，直至导弹穿出烟幕团。

\subsubsection{联立解方程组计算出烟幕团运动轨迹与导弹运动轨迹的交点}
联立烟幕团轨迹方程与导弹M1轨迹方程，计算出其交点$P_2,P_3$，则导弹M1进入烟幕团的时间$t_{\text{进入}}$为$P_2$对应的时刻，导弹M1飞出烟幕团的时间$t_{\text{飞出}}$为$P_3$对应的时刻。由代数计算得出$t_{\text{进入}} = 9.38s,t_{\text{飞出}} = 9.45s$。

\subsubsection{计算出有效遮挡时长$t$}
则有效遮挡时长$t =(t_\text{遮蔽}- t_\text{进入}) + (t_{\text{飞出}} - t_{\text{进入}}) = (9.38s - 7.21s) + (9.45s - 9.38s) = 2.24s$。

\textit{综上所述，在问题一中，无人机FY1以$120\,\mathrm{m/s}$的速度沿假目标方向飞行，并于$1.5\,\mathrm{s}$后投掷烟幕弹，烟幕弹在投掷后$3.6\,\mathrm{s}$起爆。通过对导弹轨迹与烟幕团运动轨迹的精确建模与联立求解，最终计算得到对真目标的有效遮蔽时长为$2.24\,\mathrm{s}$。}

\subsection{问题二模型求解}
\subsubsection{黎曼积分算法求值}
\begin{itemize}
    \item 最佳无人机速度$v_\text{无人机}=72.3m /s$
    \item 最佳无人机飞行方向$\aleph = 2.4rad$
    \item 最佳引信时间$\Delta t = 1.58s$
    \item 最佳投掷时间$t_1 = 0.23s$
\end{itemize}
综上代入模型，得出有效遮挡时长$T = 4.71s$。
\subsubsection{变量区块化搜索算法求值}
\begin{center}
烟幕干扰弹对 $M_1$ 的有效遮蔽时满足：
\[
\left\{
\begin{aligned}
&\bigl\|\overrightarrow{CB'''}\bigr\|^{2}
- \left(\frac{\overrightarrow{CB'''}\cdot\overrightarrow{CA}}{\|\overrightarrow{CA}\|}\right)^{2}
\le 10^{2}, \\[4pt]
&17790+v_{FY1}\bigl(t'+t_{\text{间隔}}\bigr)\cos\alpha
\le 20000 - v_{M1}\,t\cos\theta_1
\le 17810+v_{FY1}\bigl(t'+t_{\text{间隔}}\bigr)\cos\alpha, \\[4pt]
&v_FY_1 t \sin\alpha-10 \le v_{FY_1}\,t\sin\alpha \le 10+v_FY_1 t \sin \alpha
, \\[4pt]
&17790-5\,t_{\text{间隔}}^{2}-3\bigl(t-t'-t_{\text{间隔}}\bigr)
\le 2000 - v_{M1}\,t\sin\theta_1 \\ 
&\qquad\qquad\qquad\qquad\qquad\qquad
\le 1810-5\,t_{\text{间隔}}^{2}-3\bigl(t-t'-t_{\text{间隔}}\bigr).
\end{aligned}
\right.
\]
\end{center}


\begin{itemize}
    \item 从上到下分别为不等式$1,2,3,4$
    \item 不等式1的区间左端点为遮挡初始时刻
    \item 取不等式2，3，4所得区间最小右端点为遮挡末时刻
\end{itemize}
% ...existing
\subsection{问题三模型求解}
以下为程序运行所得到的最优决策，在多次运行程序后，所得数据在运行结果中较为稳定，因此认为所得结果可信度较高。

\begin{itemize}
    \item 
\end{itemize}



\subsection{问题四模型求解}

\subsection{问题五模型求解}

\section{模型优缺点及展望}
本研究在此次论文写作、问题研究中有不少的创新点但同时也存在不足。一下对本次论文写做进行复盘和为后续研究提供方向

\subsection{模型优点分析}

本研究中用到了如解析几何、黎曼积分、模拟退火等数种算法，具有一定的创新性，能够比较好地做出最佳决策。具体而言：

\begin{itemize}
    \item \textbf{多方法融合：} 通过将解析几何、运动学建模与现代智能优化算法（如模拟退火、区块化搜索、黎曼积分思想）相结合，兼顾了物理过程的精确性与算法的全局搜索能力，提升了模型的适应性和鲁棒性。
    \item \textbf{模型简化与变量降维：} 针对问题的空间结构和变量间的相关性，合理简化模型，将复杂的多变量问题转化为低维优化问题，有效降低了计算复杂度。
    \item \textbf{判定函数创新：} 提出了基于几何判别式的有效遮挡判定函数（isoccluded），能够精确判断导弹与烟幕团的空间关系，实现了对有效遮蔽时长的自动化、精细化计算。
    \item \textbf{算法适应性强：} 针对不同问题规模和复杂度，灵活选用区块化搜索、模拟退火、遗传算法等优化方法，能够应对变量多、约束复杂的高维优化场景。
    \item \textbf{可扩展性好：} 所建模型和算法框架可方便地扩展到多无人机、多导弹、多烟幕弹等更复杂的场景，具有较强的通用性和工程应用价值。
\end{itemize}

综上，本研究的模型在理论创新性、算法多样性和实际应用价值等方面均具有优势。

\subsection{模型缺点分析}
本研究采用模拟退火算法进行求解，存在一定的不足，其结果只能看作为最优解的近似解。并且本研究对问题四、问题五的研究没有十分有效的研究方法。

具体而言，模型的主要不足体现在以下几个方面：

\begin{itemize}
    \item \textbf{全局最优性难以保证：} 模拟退火算法虽然具备跳出局部最优的能力，但其最终结果受初始参数（如初始温度、降温速率等）和随机性的影响较大，不能严格保证获得全局最优解，尤其在高维复杂问题中，最优性和稳定性存在一定不确定性。
    \item \textbf{参数敏感性与调优难度：} 算法的性能高度依赖于参数设置，参数选择不当可能导致收敛速度慢或陷入局部最优，实际应用中需要大量实验进行调优，增加了模型应用的复杂度。
    \item \textbf{计算效率有限：} 随着变量数量和约束条件的增加，模拟退火和区块化搜索等方法的计算量呈指数级增长，求解大规模多无人机、多导弹、多烟幕弹的高维优化问题时，计算效率较低，难以满足实时性要求。
    \item \textbf{模型简化带来的误差：} 为降低建模和计算难度，部分物理过程（如空气阻力、风速、烟幕扩散等）被简化或忽略，可能导致模型与实际场景存在一定偏差，影响结果的准确性和工程适用性。
    \item \textbf{高维耦合问题求解能力有限：} 对于问题四、问题五等多无人机、多导弹协同优化场景，现有方法主要依赖定性分析和启发式算法，缺乏系统的全局优化框架，难以充分挖掘变量间的协同关系，优化结果可能不够理想。
    \item \textbf{缺乏实际数据验证：} 本研究主要基于理论建模和仿真，缺乏实际工程数据的验证，模型的泛化能力和实际应用效果有待进一步检验。
\end{itemize}

综上，虽然本研究在理论建模和算法设计方面取得了一定进展，但在全局最优性、计算效率、模型精度和高维协同优化等方面仍有提升空间，后续可结合更高效的智能优化算法和实际数据进一步完善模型。

\subsection{模型展望}
加入遗传算法等更加智能的随机算法到问题的研究中，



\section*{附录}
\vspace{-1em}
% ...existing code...
\begin{thebibliography}{99}

\bibitem{Lu2024}
陆胜锋. 计算机模拟退火优化算法监测模型及模拟试验[J]. 技术与市场, 2024, 31(03):87--91.

\bibitem{Shao2017}
邵勇. 遗传算法、模拟退火算法和混合算法在计算机设计中的应用[J]. 中国建材科技, 2017, 26(04):151--152.

\bibitem{Li2020}
厉丹, 康晓凤, 张丽娜, 等. 计算机应用考试系统的模拟退火算法研究[J]. 现代电子技术, 2020, 43(07):107--110.

\bibitem{Mu2015}
穆东, 王超, 王胜春, 等. 基于并行模拟退火算法求解时间依赖型车辆路径问题[J]. 计算机集成制造系统, 2015, 21(06):1626--1636.

\bibitem{Xie1998a}
谢云. 模拟退火算法综述[J]. 计算机应用研究, 1998(05):7--9.

\bibitem{Xie1998b}
谢云. 模拟退火算法综述[J]. 微计算机信息, 1998(05):63--65.

\end{thebibliography}

文中的所有的程序源代码：https://github.com/mikulovesuki/-------.git

\noindent

\end{document}
